{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/sarif-2.1/schema/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "Checkov", "version": "3.2.497", "informationUri": "https://checkov.io", "rules": [{"id": "CKV_AWS_273", "name": "Ensure access is controlled through SSO and not AWS IAM defined users", "shortDescription": {"text": "Ensure access is controlled through SSO and not AWS IAM defined users"}, "fullDescription": {"text": "Ensure access is controlled through SSO and not AWS IAM defined users"}, "help": {"text": "Ensure access is controlled through SSO and not AWS IAM defined users\nResource: aws_iam_user.ci_user"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-273"}, {"id": "CKV_AWS_355", "name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "shortDescription": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions"}, "fullDescription": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions"}, "help": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions\nResource: aws_iam_user_policy.ci_user_ro"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355"}, {"id": "CKV_AWS_40", "name": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)", "shortDescription": {"text": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)"}, "fullDescription": {"text": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)"}, "help": {"text": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)\nResource: aws_iam_user_policy.ci_user_ro"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-16-iam-policy-privileges-1"}, {"id": "CKV_AWS_24", "name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "shortDescription": {"text": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"}, "fullDescription": {"text": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"}, "help": {"text": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\nResource: aws_security_group.allow_all"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security"}, {"id": "CKV_AWS_23", "name": "Ensure every security group and rule has a description", "shortDescription": {"text": "Ensure every security group and rule has a description"}, "fullDescription": {"text": "Ensure every security group and rule has a description"}, "help": {"text": "Ensure every security group and rule has a description\nResource: aws_security_group.allow_all"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31"}, {"id": "CKV_AWS_382", "name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "shortDescription": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "fullDescription": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "help": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1\nResource: aws_security_group.allow_all"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382"}, {"id": "CKV2_AWS_5", "name": "Ensure that Security Groups are attached to another resource", "shortDescription": {"text": "Ensure that Security Groups are attached to another resource"}, "fullDescription": {"text": "Ensure that Security Groups are attached to another resource"}, "help": {"text": "Ensure that Security Groups are attached to another resource\nResource: aws_security_group.allow_all"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis"}], "organization": "bridgecrew"}}, "results": [{"ruleId": "CKV_AWS_273", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure access is controlled through SSO and not AWS IAM defined users"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "infra/terraform/iam.tf"}, "region": {"startLine": 1, "endLine": 4, "snippet": {"text": "resource \"aws_iam_user\" \"ci_user\" {\n  name = \"devsecops-demo-ci-user\"\n  path = \"/\"\n}\n"}}}}]}, {"ruleId": "CKV_AWS_355", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "infra/terraform/iam.tf"}, "region": {"startLine": 11, "endLine": 31, "snippet": {"text": "resource \"aws_iam_user_policy\" \"ci_user_ro\" {\n  name = \"ecr-read-only\"\n  user = aws_iam_user.ci_user.name\n\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:BatchGetImage\",\n        \"ecr:BatchCheckLayerAvailability\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\nEOF\n}\n"}}}}]}, {"ruleId": "CKV_AWS_40", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "infra/terraform/iam.tf"}, "region": {"startLine": 11, "endLine": 31, "snippet": {"text": "resource \"aws_iam_user_policy\" \"ci_user_ro\" {\n  name = \"ecr-read-only\"\n  user = aws_iam_user.ci_user.name\n\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:BatchGetImage\",\n        \"ecr:BatchCheckLayerAvailability\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\nEOF\n}\n"}}}}]}, {"ruleId": "CKV_AWS_24", "ruleIndex": 3, "level": "error", "attachments": [], "message": {"text": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "infra/terraform/security.tf"}, "region": {"startLine": 1, "endLine": 21, "snippet": {"text": "resource \"aws_security_group\" \"allow_all\" {\n  name        = \"allow_all\"\n  description = \"Allow all inbound traffic\"\n  vpc_id      = \"vpc-12345678\" # Mock VPC ID\n\n  # VULNERABILITY: Allowing 0.0.0.0/0 on port 22\n  ingress {\n    description = \"SSH from anywhere\"\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_23", "ruleIndex": 4, "level": "error", "attachments": [], "message": {"text": "Ensure every security group and rule has a description"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "infra/terraform/security.tf"}, "region": {"startLine": 1, "endLine": 21, "snippet": {"text": "resource \"aws_security_group\" \"allow_all\" {\n  name        = \"allow_all\"\n  description = \"Allow all inbound traffic\"\n  vpc_id      = \"vpc-12345678\" # Mock VPC ID\n\n  # VULNERABILITY: Allowing 0.0.0.0/0 on port 22\n  ingress {\n    description = \"SSH from anywhere\"\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_382", "ruleIndex": 5, "level": "error", "attachments": [], "message": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "infra/terraform/security.tf"}, "region": {"startLine": 1, "endLine": 21, "snippet": {"text": "resource \"aws_security_group\" \"allow_all\" {\n  name        = \"allow_all\"\n  description = \"Allow all inbound traffic\"\n  vpc_id      = \"vpc-12345678\" # Mock VPC ID\n\n  # VULNERABILITY: Allowing 0.0.0.0/0 on port 22\n  ingress {\n    description = \"SSH from anywhere\"\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_5", "ruleIndex": 6, "level": "error", "attachments": [], "message": {"text": "Ensure that Security Groups are attached to another resource"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "infra/terraform/security.tf"}, "region": {"startLine": 1, "endLine": 21, "snippet": {"text": "resource \"aws_security_group\" \"allow_all\" {\n  name        = \"allow_all\"\n  description = \"Allow all inbound traffic\"\n  vpc_id      = \"vpc-12345678\" # Mock VPC ID\n\n  # VULNERABILITY: Allowing 0.0.0.0/0 on port 22\n  ingress {\n    description = \"SSH from anywhere\"\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n"}}}}]}]}]}